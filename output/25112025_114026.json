{
  "detailed_report": {
    "document_title": "Self-Replicating NPM Worm Disrupts Open Source Supply Chain",
    "blocks": [
      {
        "type": "section_block",
        "level": 2,
        "title": "Event Overview",
        "content": "In September and November 2025, a highly automated self-replicating worm, dubbed “Shai-Hulud,” struck the npm JavaScript package ecosystem. The attack compromised hundreds of popular npm packages—impacting not only package maintainers but also critical downstream software supply chains, including organizations like PostHog, Postman, and AsyncAPI. Attackers leveraged install lifecycle scripts such as 'postinstall' and 'preinstall', malicious JavaScript payloads (setup_bun.js, bun_environment.js), and credential-stealing techniques to spread the worm at unprecedented speed and scale. By harvesting and exfiltrating secrets via public GitHub repositories named “Shai-Hulud” and abusing compromised credentials to proliferate, the campaign demonstrated new levels of automation, persistence, and potential for destructive impact. Threat actor attribution remains unconfirmed.\n\n**Key Findings:**\n- **Vector / Entry Point:** Compromised npm maintainer accounts (via phishing, credential reuse, or CI/CD workflow exploitation) allowed attackers to inject malicious install scripts into widely used packages.\n- **Impact:** Over 500 npm packages and at least 25,000+ downstream repositories compromised, including those linked with the PostHog, Postman, and AsyncAPI ecosystems, with threats to cloud infrastructure, secrets, code provenance, and business operations for thousands of organizations.\n- **Actor / Attribution:** The campaign’s operator remains unidentified; no claim or strong evidence exists to tie the worm to a known group. Observed techniques overlap with previous npm threats but are not linked to any specific APT or crime syndicate.\n- **Technique / Innovation:** Worm self-replication using install lifecycle hooks, TruffleHog-based secret scanning, mass credential exfiltration to attacker-named GitHub accounts, and propagation to all accessible packages with harvested tokens; AI-assisted payload generation observed.\n- **Relevance:** The attack exposes deep-rooted weaknesses in open source supply chain trust models and CI/CD authentication, escalating the urgency for robust controls and software provenance strategies [1][2][3][4][5][6][7][8][9][10][11][12][13][14][15][16]."
      },
      {
        "type": "definition_list_component",
        "title": "Attacker Profile",
        "item_key_display_name": "Field",
        "item_value_display_name": "Details",
        "items": [
          {
            "key": "Attacker Name",
            "value": "Unknown (No confirmed attribution to any group)"
          },
          {
            "key": "Profile",
            "value": "- The attacker operated with a high degree of automation, leveraging phishing and prior supply chain weaknesses to gain privileged access to npm maintainer and CI/CD accounts.\n- No overt signs tie the style to known APTs, criminal groups, or state actors; the attack drew heavily from recent npm supply chain intrusions but introduced novel worm-like capabilities and deployment at scale.\n- Behavior suggests familiarity with both JavaScript ecosystems and common CI/CD patterns; portions of malicious code contain comments and features consistent with AI- or LLM-assisted development [3][10][17]."
          }
        ]
      },
      {
        "type": "definition_list_component",
        "title": "Malware Tools and Mechanisms",
        "item_key_display_name": "Tool/Method",
        "item_value_display_name": "Description",
        "items": [
          {
            "key": "setup_bun.js / bun_environment.js",
            "value": "Malicious JavaScript files serving as the primary payloads in the second and most destructive variant, initiating secret harvesting and lateral spread; setup_bun.js acts as a dropper, while bun_environment.js executes credential theft and worm routines [6][8][11][14][15]."
          },
          {
            "key": "Lifecycle Script Abuse",
            "value": "Malicious code embedded in ‘postinstall’ and ‘preinstall’ npm hooks triggers with every install event—including on CI/CD runners, development machines, and servers [3][4][5][6][8][11]."
          },
          {
            "key": "TruffleHog Integration",
            "value": "Used for automated scanning of environment variables, configuration files, and CI/CD-specific secrets to detect cloud keys, SSH keys, npm tokens, and more [4][6][9][12][13]."
          },
          {
            "key": "Automated Propagation Logic",
            "value": "Worm logic uses harvested npm tokens to enumerate all packages the compromised developer can publish, force-updating those packages with identical malicious code."
          },
          {
            "key": "Exfiltration via GitHub",
            "value": "Stolen secrets are committed or pushed to attacker-created or victim-coopted public GitHub repositories named “Shai-Hulud”/“Sha1-Hulud: The Second Coming” for mass access and further automation [6][8][10]."
          },
          {
            "key": "Malicious GitHub Actions Workflows",
            "value": "Infected code injects persistent workflows that continue exfiltration and can enable remote code execution on self-hosted CI runners [8][11][12]."
          },
          {
            "key": "Wiper Functionality",
            "value": "In some scenarios, when exfiltration is blocked, the worm wipes user home directories and critical files—escalating the threat from espionage to active denial of service [6][14][15]."
          }
        ]
      },
      {
        "type": "definition_list_component",
        "title": "Vulnerabilities Exploited",
        "item_key_display_name": "Vulnerability",
        "item_value_display_name": "Details",
        "items": [
          {
            "key": "Credential Theft and Reuse",
            "value": "Attackers exploited stolen npm and GitHub credentials, often acquired through phishing, prior leaks, insufficient token hygiene, and exploitation of misconfigured GitHub Actions workflows [3][4][6][8][10][12]."
          },
          {
            "key": "Lifecycle Script Overtrust",
            "value": "npm’s default trust for install-time scripts allowed attackers to achieve code execution on any system or pipeline installing an infected package."
          },
          {
            "key": "Insufficient Outbound Network Controls",
            "value": "Many CI/CD environments allowed unfettered outbound connections, making exfiltration to GitHub and webhook endpoints easy to bypass detection."
          },
          {
            "key": "Weak/Missing Multi-Factor Authentication",
            "value": "Lack of phishing-resistant 2FA on npm and GitHub accounts increased exposure, enabling the rapid hijack and propagation via developer identities."
          },
          {
            "key": "Inadequate Dependency Management",
            "value": "Overreliance on unpinned dependencies and lack of SBOM (Software Bill of Materials) validation allowed transitive package updates to auto-bring in compromised code [4][8][12][13][14]."
          }
        ]
      },
      {
        "type": "mitre_attack_chain_component",
        "title": "Attack Chain",
        "attack_chain": [
          {
            "date": null,
            "action": "Attackers used phishing and exploitation of developer process weaknesses to compromise npm and GitHub accounts. In some cases, prior leaks or exploitation of vulnerable GitHub Actions workflows (notably through permissive pull_request_target use) yielded privileged tokens [4][6][8][10][17].",
            "tactic": {
              "id": "TA0001",
              "name": "Initial Access"
            },
            "techniques": [
              {
                "id": "T1566",
                "name": "Phishing"
              },
              {
                "id": "T1557",
                "name": "Adversary-in-the-Middle"
              },
              {
                "id": "T1556",
                "name": "Modify Authentication Process"
              },
              {
                "id": "T1195",
                "name": "Supply Chain Compromise"
              }
            ]
          },
          {
            "date": null,
            "action": "Infected packages published to npm with malicious 'postinstall' or 'preinstall' lifecycle hooks, dropping JS payloads (setup_bun.js, bun_environment.js).",
            "tactic": {
              "id": "TA0005",
              "name": "Defense Evasion"
            },
            "techniques": [
              {
                "id": "T1129",
                "name": "Execution through Module Load"
              },
              {
                "id": "T1059.007",
                "name": "JavaScript"
              },
              {
                "id": "T1546.003",
                "name": "Event Triggered Execution: Unix Shell Configuration Modification"
              }
            ]
          },
          {
            "date": null,
            "action": "Malicious scripts executed in victim environments (developer workstations, CI/CD agents), systematically scanning for GitHub PATs, npm tokens, SSH keys, and cloud API credentials.",
            "tactic": {
              "id": "TA0006",
              "name": "Credential Access"
            },
            "techniques": [
              {
                "id": "T1552",
                "name": "Unsecured Credentials"
              },
              {
                "id": "T1555.003",
                "name": "Credentials from Web Browsers"
              }
            ]
          },
          {
            "date": null,
            "action": "Harvested secrets are encoded, stored in files like cloud.json/truffleSecrets.json, and programmatically pushed to public GitHub repositories named “Shai-Hulud”; secondary endpoints include webhook[.]site [6][8][10][11][13][14].",
            "tactic": {
              "id": "TA0010",
              "name": "Exfiltration"
            },
            "techniques": [
              {
                "id": "T1567.002",
                "name": "Exfiltration to Cloud Storage"
              },
              {
                "id": "T1041",
                "name": "Exfiltration Over C2 Channel"
              }
            ]
          },
          {
            "date": null,
            "action": "Worm logic uses active npm tokens to enumerate and push new trojanized versions of all other packages the compromised publisher can access, recursively relaunching the cycle.",
            "tactic": {
              "id": "TA0008",
              "name": "Lateral Movement"
            },
            "techniques": [
              {
                "id": "T1550.003",
                "name": "Pass the Ticket"
              },
              {
                "id": "T1021.002",
                "name": "SMB/Windows Admin Shares"
              },
              {
                "id": "T1135",
                "name": "Network Share Discovery"
              }
            ]
          },
          {
            "date": null,
            "action": "Infected environments get new GitHub Actions workflows (e.g., shai-hulud-workflow.yml), rogue self-hosted runners (“SHA1HULUD”), and sometimes destructive wiper code if secondary propagation fails.",
            "tactic": {
              "id": "TA0003",
              "name": "Persistence"
            },
            "techniques": [
              {
                "id": "T1546.008",
                "name": "Systemd Service"
              },
              {
                "id": "T1078",
                "name": "Valid Accounts"
              },
              {
                "id": "T1489",
                "name": "Data Destruction"
              }
            ]
          },
          {
            "date": null,
            "action": "Some variants make private repos public, escalate privileges within organizations, or enable attacker-initiated further credential theft and worm expansion efforts [6][9][10][11][14][16].",
            "tactic": {
              "id": "TA0004",
              "name": "Privilege Escalation"
            },
            "techniques": [
              {
                "id": "T1068",
                "name": "Exploitation for Privilege Escalation"
              },
              {
                "id": "T1134",
                "name": "Access Token Manipulation"
              }
            ]
          }
        ]
      },
      {
        "type": "section_block",
        "level": 2,
        "title": "Impact and Scope",
        "content": "The attack compromised over 500 npm packages—including high-profile maintainers and packages (“@ctrl/tinycolor,” “@ensdomains,” “Postman,” “PostHog,” “@asyncapi/specs”)—and rapidly led to over 25,000 public repositories being exposed or compromised through lateral spread [4][6][8][10][13]. Impact included:\n\n- **Credentials and Secret Theft:** Exposure of NPM tokens, GitHub PATs, cloud API keys (AWS, Azure, GCP), SSH keys, and other sensitive development pipeline credentials.\n- **Cloud & Production Risk:** Stolen tokens enabled potential further attacks on cloud environments, production infrastructure, and customer data, including risk of data theft, ransomware, and cryptomining.\n- **Operational Disruption:** Malicious code in open source dependencies spread to downstream consumers, CI/CD environments, and production codebases, leading to broad process disruptions and emergency incident response for thousands of organizations.\n- **Persistence and Extortion:** Attackers established persistence through automation scripts and could potentially revisit compromised projects at will until credentials were comprehensively rotated, workflows purged, and dependencies restored.\n- **Supply Chain Amplification:** The worm turned each newly compromised maintainer into a further attack vector, propagating across a vast transitive dependency network.\n- **Destructive Damage:** Variants with destructive (‘wiper’) payloads risked large-scale data loss for build environments or development endpoints [6][8][10][11][13]."
      },
      {
        "type": "section_block",
        "level": 2,
        "title": "CI/CD Security Lessons and Defensive Actions",
        "content": "**Analytical Summary:**\nThe Shai-Hulud npm worm leveraged a perfect storm of ecosystem trust, credential weaknesses, and CI/CD scripting overexposure, demonstrating that software supply chain security is only as strong as its least-protected maintainer or pipeline. Its exponential self-replication, leveraging install lifecycle scripts and credential exfiltration, made detection and containment difficult until the attack had reached a massive scale. The incident highlights the critical importance of enforcing strong account security, restricting pipeline privileges, and deploying upstream controls on third-party dependencies.\n\n**Tactical Recommendations:**\n- **Remove Malicious Packages:** Audit and immediately remove or roll back all affected package versions; blocklist known malicious versions and clear local and pipeline caches [4][6][8][10][12].\n- **Rotate and Revoke All Credentials:**\n    - Immediately rotate npm tokens, GitHub PATs, SSH keys, and cloud API credentials for all affected projects and users.\n    - Invalidate any automation tokens or credentials that may have been present in compromised environments [4][8][10][11][12].\n- **Audit and Limit Lifecycle Scripts:**\n    - Disable lifecycle scripts (postinstall, preinstall) in CI/CD and development environments where not strictly necessary.\n    - Review package.json files for addition of or changes to lifecycle hooks [4][6][8][10][16].\n- **Secure CI/CD Pipelines:**\n    - Harden build servers with outbound network restrictions—block connections to known exfiltration endpoints (e.g., webhook[.]site, attacker Github repos).\n    - Segment sensitive stages and restrict privilege escalation, particularly for automated publishing or privileged tokens [1][4][12][13][16].\n- **Enforce Strong Authentication:**\n    - Require phishing-resistant multi-factor authentication (preferably FIDO/WebAuthn/U2F) for all npm and GitHub accounts with publish or admin access.\n    - Rotate all tokens to shortest feasible lifespans, restrict scopes, monitor for long-lived or overprivileged tokens [4][11][12].\n- **Monitor for Indicators of Compromise:**\n    - Search for unauthorized or suspicious GitHub repositories named “Shai-Hulud,” “Sha1-Hulud: The Second Coming,” or variants.\n    - Hunt for malicious workflow files (e.g., shai-hulud-workflow.yml), unexpected branches, and creation of self-hosted runners (“SHA1HULUD”) [4][6][10][11][12].\n- **Implement Supply Chain Hygiene:**\n    - Pin production dependencies to exact, known-safe versions (preferably released prior to September 16, 2025).\n    - Employ Software Bill of Materials (SBOM) tooling, third-party SCA, and consider delayed package update policies (e.g., pnpm minimumReleaseAge) to minimize exposure to fresh malicious uploads [4][9][12][14].\n- **Monitor Access and Anomalies:**\n    - Enable and review CI/DC pipeline logs, repository access logs, and developer endpoint telemetry for signs of abnormal API activity, package version bumps, or suspicious network calls [4][6][8][10][13][16].\n- **Review and Remove Malicious Workflows:**\n    - Identify and remove any GitHub Actions workflows (especially ones referencing Shai-Hulud or triggering on pull_request_target/discussion events) added after September 2025.\n    - Examine for modified workflow privileges, persistence via self-hosted runners, or secret scraping behavior [4][6][8][10][11][13][14][15].\n- **Promote Developer & QA Education:**\n    - Educate all team members on phishing resistance, safe package management, and best practices for secret storage in local and CI environments [4][12][17].\n- **Enhance Detection:**\n    - Deploy automated detection scripts for known Shai-Hulud indicators, as released by the open source community and vendors.\n    - Subscribe to supply chain threat intelligence streams and advisories for up-to-date malicious package lists [6][8][11][12][13].\n\n**Open Knowledge Gaps:**\n- No public, comprehensive post-mortems or technical breakdowns have been published by the PostHog, Postman, or AsyncAPI projects as of November 2025; ecosystem advisories and threat intelligence reports cover impact and package names, but concrete timelines and code artifacts remain limited.\n- Full, line-by-line reverse engineering of setup_bun.js and bun_environment.js remains unpublished in advisories, out of risk of facilitating further exploitation; behavioral descriptions are used for analysis instead."
      },
      {
        "type": "sources_component",
        "title": "Sources",
        "sources": [
          {
            "number": 1,
            "title": "Widespread Supply Chain Compromise Impacting npm Ecosystem",
            "url": "https://www.cisa.gov/news-events/alerts/2025/09/23/widespread-supply-chain-compromise-impacting-npm-ecosystem"
          },
          {
            "number": 2,
            "title": "Wormable Malware Causing Supply Chain Compromise of npm ...",
            "url": "https://arcticwolf.com/resources/blog/wormable-malware-causing-supply-chain-compromise-of-npm-code-packages/"
          },
          {
            "number": 3,
            "title": "Ride the Worm: NPM Packages Hit by Shai-Hulud - ArmorCode",
            "url": "https://www.armorcode.com/blog/npm-packages-hit-by-shai-hulud-and-mastering-supply-chain-attack-response"
          },
          {
            "number": 4,
            "title": "Shai-Hulud 2.0 Supply Chain Attack: 25K+ Repos Exposing Secrets",
            "url": "https://www.wiz.io/blog/shai-hulud-2-0-ongoing-supply-chain-attack"
          },
          {
            "number": 5,
            "title": "\"Shai-Hulud\" Worm Compromises npm Ecosystem in Supply Chain ...",
            "url": "https://unit42.paloaltonetworks.com/npm-supply-chain-attack/"
          },
          {
            "number": 6,
            "title": "Shai-Hulud: The novel self-replicating worm infecting hundreds of ...",
            "url": "https://www.sysdig.com/blog/shai-hulud-the-novel-self-replicating-worm-infecting-hundreds-of-npm-packages"
          },
          {
            "number": 7,
            "title": "Ongoing npm Software Supply Chain Attack Exposes New Risks",
            "url": "https://www.sonatype.com/blog/ongoing-npm-software-supply-chain-attack-exposes-new-risks"
          },
          {
            "number": 8,
            "title": "Sha1-Hulud: The Second Coming of the NPM Worm is Digging For ...",
            "url": "https://semgrep.dev/blog/2025/digging-for-secrets-sha1-hulud-the-second-coming-of-the-npm-worm"
          },
          {
            "number": 9,
            "title": "npm Under Siege: Evolving Supply Chain Threats",
            "url": "https://cymulate.com/blog/npm-under-siege-supply-chain-attacks/"
          },
          {
            "number": 10,
            "title": "Sha1-Hulud: The Second Coming - Zapier, ENS Domains, and ...",
            "url": "https://www.stepsecurity.io/blog/sha1-hulud-the-second-coming-zapier-ens-domains-and-other-prominent-npm-packages-compromised"
          },
          {
            "number": 11,
            "title": "Shai-Hulud 2.0 Supply Chain Attack: 25K+ Repos Exposing Secrets",
            "url": "https://www.wiz.io/blog/shai-hulud-2-0-ongoing-supply-chain-attack"
          },
          {
            "number": 12,
            "title": "The Second Coming: Shai-Hulud Is Back at It – How to Protect Your ...",
            "url": "https://www.ox.security/blog/the-second-coming-shai-hulud-is-back-at-it-how-to-protect-your-org/"
          },
          {
            "number": 13,
            "title": "A simple project to detect the Shai-Hulud npm supply chain attack",
            "url": "https://github.com/Cobenian/shai-hulud-detect"
          },
          {
            "number": 14,
            "title": "Shai-Hulud 2.0 npm Supply Chain Attack Technical Analysis",
            "url": "https://safedep.io/shai-hulud-second-coming-supply-chain-attack/"
          },
          {
            "number": 15,
            "title": "Shai-hulud npm attack: What you need to know - ReversingLabs",
            "url": "https://www.reversinglabs.com/blog/shai-hulud-worm-npm"
          },
          {
            "number": 16,
            "title": "Mitigating Risks from the Shai-Hulud NPM Worm | ThreatLabz",
            "url": "https://www.zscaler.com/blogs/security-research/mitigating-risks-shai-hulud-npm-worm"
          },
          {
            "number": 17,
            "title": "What We Know About the NPM Supply Chain Attack | Trend Micro (US)",
            "url": "https://www.trendmicro.com/en_us/research/25/i/npm-supply-chain-attack.html"
          }
        ]
      },
      {
        "type": "limitations_component",
        "title": "Important",
        "content": "This content was generated with the assistance of AI and may contain inaccuracies or omissions. Please verify critical information independently."
      }
    ]
  },
  "summary_page": {
    "bluf_block": {
      "type": "bluf_block",
      "title": "Bottom Line",
      "content": "A highly automated self-replicating worm, leveraging compromised npm maintainer accounts, has infiltrated hundreds of npm packages and disrupted critical supply chains at scale. This presents a credible exposure for organizations depending on public JavaScript dependencies, with risks including credential theft, operational disruption, and potential data loss. Exposed organizations should consider immediate removal of impacted packages and a full rotation of all developer credentials to halt propagation and prevent further compromise."
    },
    "now_what_block": {
      "type": "now_what_block",
      "title": "Now What",
      "intro_sentence": "Exposed organizations should consider the following actions, prioritized for rapid risk reduction and long-term resilience:",
      "action_groups": [
        {
          "group_title": "Immediate Containment",
          "executive_summary": "Remove worm-affected npm packages and block ongoing malicious activity to prevent further lateral spread and data exfiltration.",
          "action_items": [
            "Identify and remove all impacted or suspicious npm package versions from production, development, and CI/CD environments.",
            "Clear all local and pipeline caches where compromised packages may persist.",
            "Block known exfiltration endpoints (e.g., malicious GitHub repositories, webhook[.]site) at the network level."
          ]
        },
        {
          "group_title": "Credential and Pipeline Hygiene",
          "executive_summary": "Eliminate attacker persistence by rapidly rotating all potentially exposed credentials and purging unauthorized scripts or workflows from CI/CD systems.",
          "action_items": [
            "Rotate npm tokens, GitHub PATs, SSH keys, and any automation or cloud credentials in all affected projects.",
            "Invalidate automation tokens and ensure all secrets have the shortest feasible lifespan and least privilege.",
            "Audit for malicious or modified GitHub Actions workflows (such as shai-hulud-workflow.yml), and remove unauthorized runners or scripts."
          ]
        },
        {
          "group_title": "Strategic Resilience Measures",
          "executive_summary": "Establish enduring defenses against future supply chain threats by restricting script execution, enforcing strong authentication, and tightening dependency management.",
          "action_items": [
            "Disable postinstall/preinstall lifecycle scripts where not strictly required, both locally and in CI/CD.",
            "Mandate phishing-resistant MFA (FIDO/WebAuthn/U2F) for all privileged npm and GitHub accounts.",
            "Pin production dependencies to exact, known-safe versions and adopt SBOM and SCA tools for continuous supply chain monitoring.",
            "Segment and harden CI/CD environments, limiting network egress and privilege escalation potentials.",
            "Educate development and QA teams on phishing resistance and secure secret handling."
          ]
        }
      ]
    },
    "so_what_block": {
      "type": "so_what_block",
      "title": "So What",
      "intro_sentence": "This incident is material due to three specific business-level risks:",
      "implications": [
        {
          "title": "End-to-End Supply Chain Exposure",
          "description": "The worm's rapid propagation mechanism leveraged trust relationships in open source, putting code provenance and the integrity of downstream production environments at direct risk."
        },
        {
          "title": "Credential and IP Theft with Amplified Lateral Impact",
          "description": "Stolen tokens, cloud API keys, and SSH credentials expose organizations to secondary cyberattacks, unauthorized data access, operational disruption, and long-tail intrusion opportunities."
        },
        {
          "title": "Systematic Weakness in Ecosystem Trust Models",
          "description": "The event exposes fundamental gaps in dependency management, script trust, and authentication practices, highlighting persistent risk for any organization relying on unvetted open source code."
        }
      ]
    },
    "whats_next_block": {
      "type": "whats_next_block",
      "title": "Whats Next",
      "intro_sentence": "Key indicators to monitor for future risk management and escalation:",
      "indicators": [
        {
          "title": "Emergence of Copycat Attacks",
          "description": "Monitor for new npm or open source packages replicating similar lifecycle-hook worming techniques, as the documented automation may incentivize additional actors."
        },
        {
          "title": "Disclosure of Additional Compromised Packages or Vendors",
          "description": "Watch for incident updates from npm registry maintainers and ecosystem vendors, as further impacted packages or revised lists may signal broader exposure or active threats."
        },
        {
          "title": "Shifts in CI/CD Security Controls and Community Policy",
          "description": "Track adoption of upgraded authentication requirements, script execution restrictions, and dependency hygiene best practices, as community or platform responses are likely to shape the future risk landscape."
        }
      ]
    }
  }
}